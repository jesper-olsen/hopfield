MNIST
==========

Download MNIST, e.g.

```
% mkdir -p MNIST
% cd MNIST
% wget http://yann.lecun.com/exdb/mnist/train-images-idx3-ubyte.gz
% wget http://yann.lecun.com/exdb/mnist/train-labels-idx1-ubyte.gz
% wget http://yann.lecun.com/exdb/mnist/t10k-images-idx3-ubyte.gz
% wget http://yann.lecun.com/exdb/mnist/t10k-labels-idx1-ubyte.gz
% gunzip *.gz
```

Run the example:

```
% cargo run --bin main_mnist
```

Hopfield networks can be used for classification if we add the class label (one-hot) to the state vector. At test time the label is 'blanked out', but will
be re-generated by the network when it settles into a low-energy state.
Here we apply Hopfield networks to the [MNIST](https://en.wikipedia.org/wiki/MNIST_database) handwritten digit task.
The MNIST images are 8-bit monochrome - for classic Hopfield networks the intensities have to be mapped to binary values which is here done 
with quantisation and one-hot encoding using 2, 4 or 8 quantisation levels.
The quantization level turns out to have little influence on accuracy - the training set has 60k images and test set 10k:

| Quantisation      | Correct |
|-------------------|----------|
| 3 bits / 8 levels | 7833     |
| 2 bits / 4 levels | 8045     |
| 1 bit  / 2 levels | 8003     |

Accuracy is ~80% - the [Forward-Forward algorithm](https://github.com/jesper-olsen/ff-py) and [Deep Boltzmann machines](https://github.com/jesper-olsen/rbm-py) achieve better than 98% on the same task - though at the cost of considerably more complexity.

Here is an example image from the test set:

![PNG](https://raw.githubusercontent.com/jesper-olsen/hopfield/master/Images/7-org.png) 

And the same image after being processed by the Hopfield network - 1 bit quantisation:

![PNG](https://raw.githubusercontent.com/jesper-olsen/hopfield/master/Images/7-q2.png) 

and 2-bit quantisation:

![PNG](https://raw.githubusercontent.com/jesper-olsen/hopfield/master/Images/7-q4.png) 

and 3-bit quantisation:

![PNG](https://raw.githubusercontent.com/jesper-olsen/hopfield/master/Images/7-q8.png) 


